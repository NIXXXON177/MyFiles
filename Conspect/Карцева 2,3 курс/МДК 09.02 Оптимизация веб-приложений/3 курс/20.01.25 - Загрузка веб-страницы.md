# Проблемные места при загрузке страницы любого сайта:

1. **==Предзагрузка==** - появление страницы в браузере пользователя. После некоторого времени ожидания загрузки при заходе на веб-ресурс у пользователя в браузере отображается нарисованная страница. В этот момент, вероятно, на странице отсутствуют рисунки и, скорее всего, не полностью функционирует JS-логика.

2. **==Интерактивная загрузка==** - появление интерактивности (и анимации) у загруженной веб-страницы. Обычно вся клиентская логика взаимодействия доступна сразу после первоначальной загрузки страницы (стадия 1), однако в некоторых случаях поддержка этой логики может немного запаздывать по времени от появления основной картинки в браузере пользователя.

3. **==Полная загрузка страницы==** - страница полностью появилась в браузере, на ней представлена вся заявленная информация, и она практически готова к дальнейшим действиям пользователя.

4. **==Пост-загрузка страницы==** - на данной стадии полностью загруженная страница может (в невидимом для пользователя режиме) осуществлять загрузку и кэширование некоторых ресурсов или компонентов. Они могут потребоваться пользователю как при переходе на другие страницы данного сайта, так и для отображения каких-либо анимационных эффектов или добавления функционала ради удобства использования.

# Схема загрузки страниц сайтов

![[Pasted image 20250120133339.png]]

Время загрузки рассчитывается в миллисекундах. Обычный человек этот параметр лучше воспринимает в секундах. (1 секунда - 1000 миллисекунд)

# Поэтапный процесс загрузки страниц сайтов в браузере

1. **==Обработка запросов к DNS-серверу==** - запрос к хосту, на котором размещен ваш сайт со всеми его потрохами, файлами и папками.
	Справка: "DNS" (Domain Name System - система доменных имен) - компьютерная распределенная система для получения информации о доменах. Чаще всего используется для получения IP-адреса по имени хоста (ПК или устройства), получения информации о маршрутизации почты, обслуживающих узлах для протокола в домене (SRV-запись).
	
	DNS-сервер, name server - приложение, предназначенное для ответов на DNS-запросы по соответствующему протоколу. Также DNS-сервером могут называть хост, на котором запущено приложение.

2. **==Обработка редиректов==** - отработка HTTP-переадресации при загрузке страницы.
	Редирект (redirect - перенаправление). Программное решение или скрипт, который принудительно перенаправляет пользователя с выбранной страницы на другую страницу.

3. **==Подключение к серверу==** - время, в течение которого браузер ожидал подключения к HTTP-серверу при получении содержимого страницы.

4. **==Ответ сервера==** - время, в течение которого передается ответ с содержимым страницы от HTTP-сервера к браузеру.

5. **==Обработка HTML (время загрузки и парсинга HTML)==** - время, в течение которого браузер обрабатывает содержимое страницы после ее загрузки с сервера и до начала отрисовки.
	На этот параметр влияет размер и сложность (количество и вложенность тегов) HTML-страницы.

6. **==Время до загрузки DOM==** - время от начала перехода на страницу до полной ее загрузки со всеми компонентами (images, css, scripts), когда страница становится доступна для взаимодействия с пользователем. Максимальное отображаемое значение этой метрики - 30 секунд.

7. **==Время от отрисовки==** - время от начала перехода на страницу до момента, когда страница начинает отрисовываться в браузере. Именно это значение субъективно воспринимается посетителем как скорость загрузки сайта. (<=2 секунд) 

# Правила оптимизации загрузки страницы

1. **Проводите минификацию файлов CSS и JS**
	==Минификация кода== - процесс удаления из него лишнего синтаксиса, не влияющего на функциональность ресурса (комментарии, повторяющиеся отступы и пробелов). Это позволяет уменьшить размер исходных CSS/JS файлов.

2. **Уменьшайте количество HTTP-запросов**
	- За отображением одной страницы часто стоит группа запросов серверу. Браузер может одновременно запрашивать разные компоненты HTML-документа - текст, изображения, таблицы стилей CSS, сценарии JS и т.д.
	- Чем выше количество таких запросов, тем больше объем передаваемых данных, а также информации в заголовках запросов. Минимизировать число обращений к серверу помогают следующие методы:
		- объединение элементов CSS и JS в отдельные файлы;
		- балансировка нагрузки путем распределения компонентов страниц между серверами;
		- встраивание inline-картинок в таблицы CSS;
		- объединение графических элементов формата SVG в один файл.

3. **Используйте поддомены для параллельного скачивания.**
	Частичное перемещение данных на отдельный поддомен и указание пути к ним в корневом файле config.php, размещенном на хостинге

4. **Размещайте элементы CSS  в начале страницы**
	Рендеринг (визуализация контента) происходит поэтапно, начиная с верхней части страницы (head). При размещении стилей внизу HTML-документа и низкой скорости интернета может возникнуть ситуация, когда контент не отображается до загрузки стилей, и пользователь видит белый экран.
	
	Подключение основных стилей в верхнем блоке head сделает процесс визуализации последовательным - от отрисовки базовых элементов до полной загрузки всех компонентов страницы.

5. **Помещайте элементы JS в конец страницы**
	Скрипты, в которых прописаны динамические сценарии, делают дизайн интерактивным и привлекательным. Они дополняют страницу, но по сравнению с текстом и изображениями не является приоритетным контентом.
	
	Особенность элементов JS в сравнительно большом объеме и синхронной загрузке. Если их разместить в верхней части HTML-документа, они могут блокировать отображение других его блоков. Для увеличения скорости загрузки страницы рекомендуем добавлять скрипты в нижней ее части.

6. **Используйте кэш браузера**
	Добиться ускорения загрузки страниц можно, благодаря кэширования. Это процесс заключается в создании копий контента ранее загруженных файлов. В результате скорость воспроизведения возрастает, поскольку браузер воспроизводит сохраненные данные, не обращаясь к серверу снова. Настроить кэширование CSS и JS - значит разрешить браузеру сохранять их копии.

	Оптимизация загрузки страницы подразумевает настройку HTTP-заголовков кэширования. 
	
	2 схемы, как ускорить загрузку интернет страниц:
	- HTTP-ответ Expires, когда при первичном запросе сервер отдает значение - дату, до которой данные будут храниться в кэше.
	- HTTP-ответ Cache-Control, когда период кэширования определен в директиве max-age.

	До указанного времени хранения кэша браузер будет обращаться к сохраненным копиям.

7. **Используйте CDN для загрузки JS-контента**
	На скорость загрузки страницы может влиять местонахождение пользователя и сервера и то, насколько далеко они находятся друг от друга. CDN (Content Delivery Network) - система, при которой серверы географически рассредоточены. При обработке запроса она выбирает сервер с наименьшим числом промежуточных узлов (хопов), что ускоряет передачу данных.
	
	У Google есть CDN - Goggle Libraries, применяемая для популярных библиотек JS. Совместное использование JS-фреймворка jQuery с Google Libraries снижают нагрузку на сервер. Кроме того, при таком подходе браузер кэширует файлы со скриптами, не загружая их повторно.

8. **Используйте архивирование gzip**
	С помощью архивирования контента можно снизить вес страниц и, как следствие, объем передаваемых данных. GZIP - формат, полученный в результате сжатия файлов. Его используют для документов с расширением .html, .css, .js.
	
	Сервер возвращает информацию в уменьшенном формате gzip, после чего браузер распаковывает и отображает содержимое страницы в исходном виде. Это ускоряет процесс загрузки в целом.
	
	Content-Encoding - заголовок сжатия текстового контента. С его помощью сервер сжимает содержимое страницы и сообщает метод сжатия: Content-Encoding: gzip. 
	Архивирование gzip настраивают в файле конфигурации. Для серверов типа Apache изменения нужно вносить в документ .htaccess, для Nginx - в nginx.conf.

9. **Уменьшайте вес изображений**
	Тяжелые изображения часто являются причиной низкой скорости отображения страниц. Оптимизация картинок подразумевает уменьшение их объема. Один из способов это сделать - произвести сжатие файлов (уменьшение веса изображения без потери качества).

10. **Уменьшайте размер изображений**
	Использование визуальных файлов в большом масштабе часто неоправданно, поскольку для четкого отображения на ПК, планшетах и смартфонах может быть достаточно картинок меньшего размера. 